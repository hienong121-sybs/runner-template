# Codex Changelog - 2026-02-13 - #01

## 1) Yeu cau thay doi
- [x] Them CLI `runner-template-patch-env` de patch file `.env` theo comment `# Path: ...` -> encode base64 vao key `*_BASE64`.
- [x] Tao wrapper entry `runner-template-patch-env.js` (giong pattern `runner-template-createtunnel.js`, `runner-template-tailscale.js`).
- [x] Dang ky `package.json` (bin + files).
- [x] Them vao menu `runner-template.js`.
- [x] Cap nhat `README.md` va `CHANGELOG.md`.

## 2) Cau hinh/env anh huong
- File `.env` duoc cap nhat in-place (tru khi dung `--dry-run`).
- Format can co:
  - `# Path: <relative-or-absolute-path>`
  - dong env assignment tiep theo (bo qua dong trong va comment) phai la key `*_BASE64`.
- Path tuong doi se resolve theo thu muc chua file `.env`.
- Flags:
  - `--dry-run`: chi log, khong ghi file.

## 3) Tom tat thay doi
- Them route/mode `patch-env` trong `runner-template-copy.js` va implement logic base64 patch.
- Them wrapper CLI moi + update aggregate menu `runner-template`.
- Dong bo docs/changelog cho CLI moi.

## 4) Chi tiet thay doi
- `runner-template-copy.js`
  - Them `PATCH_ENV_MODE_SET` va routing mode `patch-env` trong `runCli` (line 52, 62-83).
  - Them `runPatchEnvCli` + helpers parse args/resolve path/patch assignment (bat dau line 220).
- `runner-template-patch-env.js`
  - Wrapper goi `runCli(["patch-env", ...args])`.
- `package.json`
  - Them bin `runner-template-patch-env` (line 10).
  - Them file publish `runner-template-patch-env.js` (line 18).
- `runner-template.js`
  - Them command menu selector `4` + aliases `patch-env|patchenv|env-patch` (line 29-36).
  - Cap nhat help/examples (line 141+).
- `README.md`
  - Cap nhat so luong CLI (4 -> 5) va them section "CLI patch file .env" (line 38+ / 224+).
- `CHANGELOG.md`
  - Unreleased: them muc "Added" cho CLI moi (line 9+).

## 5) Git diff trong tam
```diff
diff --git a/runner-template-copy.js b/runner-template-copy.js
index a9b41c3..67fda40 100644
--- a/runner-template-copy.js
+++ b/runner-template-copy.js
@@
 const CREATE_TUNNEL_MODE_SET = new Set(["create-tunnel", "createtunnel", "tunnel"]);
 const TAILSCALE_MODE_SET = new Set(["tailscale", "acl", "access-controls"]);
+const PATCH_ENV_MODE_SET = new Set(["patch-env", "patchenv", "env-patch"]);
@@
   const tailscaleModeFromArg = TAILSCALE_MODE_SET.has(firstArg);
   const tailscaleModeFromCommandName = scriptName.includes("tailscale");
+  const patchEnvModeFromArg = PATCH_ENV_MODE_SET.has(firstArg);
+  const patchEnvModeFromCommandName = scriptName.includes("patch-env") || scriptName.includes("patchenv");
@@
-  if (createTunnelModeFromArg || tailscaleModeFromArg) {
+  if (createTunnelModeFromArg || tailscaleModeFromArg || patchEnvModeFromArg) {
     args.shift();
   }
@@
+  if (patchEnvModeFromArg || patchEnvModeFromCommandName) {
+    runPatchEnvCli(args);
+    return;
+  }
+
diff --git a/runner-template-patch-env.js b/runner-template-patch-env.js
new file mode 100644
index 0000000..74b01a7
--- /dev/null
+++ b/runner-template-patch-env.js
@@
+#!/usr/bin/env node
+
+const path = require("path");
+const { runCli } = require("./runner-template-copy");
+
+runCli(["patch-env", ...process.argv.slice(2)], {
+  scriptName: path.basename(__filename),
+}).catch((error) => {
+  console.error(`fatal: ${error.message}`);
+  process.exit(1);
+});
+
diff --git a/package.json b/package.json
index 82e0d1c..eef27e2 100644
--- a/package.json
+++ b/package.json
@@
     "runner-template-copy": "./runner-template-copy.js",
     "runner-template-createtunnel": "./runner-template-createtunnel.js",
-    "runner-template-tailscale": "./runner-template-tailscale.js"
+    "runner-template-tailscale": "./runner-template-tailscale.js",
+    "runner-template-patch-env": "./runner-template-patch-env.js"
   },
@@
     "runner-template-copy.js",
     "runner-template-createtunnel.js",
     "runner-template-tailscale.js",
+    "runner-template-patch-env.js",
diff --git a/runner-template.js b/runner-template.js
index d33af90..21ad820 100644
--- a/runner-template.js
+++ b/runner-template.js
@@
   {
     key: "3",
     aliases: ["tailscale", "acl", "access-controls", "runner-template-tailscale"],
     name: "runner-template-tailscale",
     description: "Update Tailscale Access Controls from hujson body",
     argsPrefix: ["tailscale"],
   },
+  {
+    key: "4",
+    aliases: ["patch-env", "patchenv", "env-patch", "runner-template-patch-env"],
+    name: "runner-template-patch-env",
+    description: "Patch .env by base64-encoding files referenced by '# Path:' comments",
+    argsPrefix: ["patch-env"],
+  },
 ];
@@
   console.log("  1 | copy | runner-template-copy");
   console.log("  2 | createtunnel | create-tunnel | runner-template-createtunnel");
   console.log("  3 | tailscale | acl | access-controls | runner-template-tailscale");
+  console.log("  4 | patch-env | patchenv | env-patch | runner-template-patch-env");
@@
   console.log("  runner-template 1 --force");
   console.log("  runner-template 2 --yes");
   console.log("  runner-template 3 --dry-run");
+  console.log("  runner-template 4 .env --dry-run");
diff --git a/README.md b/README.md
index f90287b..5ec7c6f 100644
--- a/README.md
+++ b/README.md
@@
-Package nay co 4 CLI:
+Package nay co 5 CLI:
@@
 - `runner-template-createtunnel`: tao Cloudflare tunnel + DNS record tu bien moi truong.
 - `runner-template-tailscale`: cap nhat Tailscale Access Controls (ACL) tu file hujson.
+- `runner-template-patch-env`: patch file `.env` tu comment `# Path:` (auto base64 file -> *_BASE64).
diff --git a/CHANGELOG.md b/CHANGELOG.md
index cfab9ea..9203e5f 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@
 ## [Unreleased]
+
+### Added
+
+- Added new CLI command `runner-template-patch-env` to patch `.env` by base64-encoding file contents referenced by `# Path:` comments.
+  - added new bin `runner-template-patch-env`
+  - added new aggregate menu selector `4` in `runner-template`
```

## 6) Verify da chay
- `node runner-template-patch-env.js --help`
- `node runner-template.js --help`
- Sanity test:
  - Tao file `.env` sample co 2 blocks `# Path:` va verify base64 duoc ghi de (ca `--dry-run` va write mode).

## 7) Commit message de xuat
```text
feat(cli): add runner-template-patch-env
```

