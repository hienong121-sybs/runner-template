# Codex Changelog - 2026-02-12 - #04

## 1) Yêu cầu thay đổi
- [x] Sửa lỗi `docker-manager` báo `No such container: tailscale` khi sync định kỳ.

## 2) Cấu hình/env ảnh hưởng
- Không bắt buộc đổi env.
- Hệ thống hỗ trợ tự động resolve theo service name compose.

## 3) Tóm tắt thay đổi
- Cập nhật `docker-manager/lib/docker-client.js` để:
  - thử container name trực tiếp trước
  - nếu không có thì lookup theo label compose `com.docker.compose.service=<name>`
  - cache resolve ngắn hạn để giảm gọi `docker ps`.

## 4) Chi tiết thay đổi
- Root cause:
  - `docker exec tailscale ...` thất bại vì container thực tế là `<project>-tailscale-1`.
- Fix:
  - thêm `resolveContainerTarget()`:
    - `docker container inspect <name>` nếu tồn tại thì dùng luôn.
    - fallback `docker ps --filter label=com.docker.compose.service=<service>` lấy container name thực tế.
  - áp dụng resolve cho toàn bộ lệnh container (exec/logs/status/restart/...).

## 5) Git diff trọng tâm
```diff
diff --git a/docker-manager/lib/docker-client.js b/docker-manager/lib/docker-client.js
@@
+  async resolveContainerTarget(containerName) { ... }
@@
-  return this.runDocker(["exec", containerName, ...commandArgs], options);
+  const resolved = await this.resolveContainerTarget(containerName);
+  return this.runDocker(["exec", resolved, ...commandArgs], options);
```

## 6) Verify đã chạy
- Không chạy test/lint theo yêu cầu.
- Rà logic code: các đường gọi `tailscale`/`nginx` scheduler giờ đều đi qua resolver mới.

## 7) Commit message đề xuất
```text
fix(docker-manager): resolve compose service names to real container names
```
